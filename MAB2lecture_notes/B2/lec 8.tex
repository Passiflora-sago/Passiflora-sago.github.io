\setcounter{chapter}{7}
\chapter{可微条件与高阶偏导数}

\section{$z = f(x,y)$在$M_0(x_0,y_0)$处可微的条件}

\begin{theorem}
    若$z = f(x,y)$在$M_0$处可微,则$f_x'(M_0),f_y'(M_0)$存在.反之未必.
\end{theorem}

\begin{proof}
    已知$z = f(x,y)$在$M_0(x_0,y_0)$处可微,则
    $$
    \Delta z = f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0) = (A \Delta x + B \Delta y) + o(\rho),
    $$
    令$\Delta y = 0$,则
    $$
    \Delta z_x = f(x_0 + \Delta x, y_0) - f(x_0, y_0) = A \Delta x + o(|\Delta x|),
    $$
    由此得
    $$
    f_x'(M_0) = \lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x, y_0) - f(x_0, y_0)}{\Delta x} = A.
    $$
    同理,令$\Delta x = 0$,则$f_y'(M_0) = B$.

    即$d z |_{M_0} = A \Delta x + B \Delta y = f_x'(M_0) \Delta x + f_y'(M_0) \Delta y \Rightarrow \dif z = f_x'(M_0) \Delta x + f_y'(M_0) \Delta y$.
    将$f_x'$记为$\frac{\partial f}{\partial x}$,将$f_y'$记为$\frac{\partial f}{\partial y}$,则
    $$
    \dif z = \frac{\partial f}{\partial x} \Delta x + \frac{\partial f}{\partial y} \Delta y = \frac{\partial f}{\partial x} \dif x + \frac{\partial f}{\partial y} \dif y.
    $$
    或者写成向量形式
    $$
    \dif z = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y} \right) \begin{pmatrix}
        \dif x \\
        \dif y
    \end{pmatrix}.
    $$
\end{proof}

\begin{theorem}{thm:8.2}
    若$f(x,y)$在$M_0$处可微,则$z = f(x,y)$在$M_0$处必连续,反之未必.
\end{theorem}

\begin{proof}
    已知$\Delta z = f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0) = f_x'(M_0) \Delta x + f_y'(M_0) \Delta y + o(\rho)$,且
    $$
    \Delta x \to 0, \Delta y \to 0,
    $$
    时,有
    $$
    f_x'(M_0) \Delta x + f_y'(M_0) \Delta y + o(\rho) \to 0, \quad o(\rho) \to 0,
    $$
    其中$\rho = \sqrt{(\Delta x)^2 + (\Delta y)^2}$,因此$\rho \to 0 \Leftrightarrow \Delta x \to 0, \Delta y \to 0$.

    从而$\lim_{\Delta x \to 0, \Delta y \to 0} \Delta z = 0 \Leftrightarrow z = f(x,y)$在$M_0$处连续.
\end{proof}

\begin{example}
    反例1: $z = f(x,y) = \sqrt{x^2 + y^2}$,在$M_0(0,0)$处连续.但因$f_x'(0,0) = f_y'(0,0) $都不存在,所以$f(x,y)$在$M_0$处不可微.
\end{example}

\begin{example}
    反例2: $z = f(x,y) = \begin{cases}
        \frac{x^2 y}{x^4 + y^2}, & (x,y) \neq (0,0), \\
        0, & (x,y) = (0,0).
    \end{cases}$
    在$(0,0)$处有$f_x'(0,0) = f_y'(0,0) = 0$,但$\lim_{(x,y) \to (0,0)} f(x,y)$不存在,所以$f(x,y)$在$(0,0)$处不连续.
    由\ref{thm:8.2}可知$f(x,y)$在$(0,0)$处不可微.
\end{example}

\begin{theorem}
    $z = f(x,y)$在$M_0(x_0,y_0)$处可微的充分必要条件是
    $$
    \lim_{\rho \to 0} \frac{\Delta z - f_x'(M_0)\Delta x - f_y'(M_0)\Delta y}{\rho} = 0.
    $$
\end{theorem}

\begin{proof}
    若$z = f(x,y)$在$M_0$处可微,则
    $$
    \Delta z = f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0) = f_x'(M_0) \Delta x + f_y'(M_0) \Delta y + o(\rho),
    $$
    由此得
    $$
    \lim_{\rho \to 0} \frac{\Delta z - f_x'(M_0) \Delta x - f_y'(M_0) \Delta y}{\rho} = \lim_{\rho \to 0} \frac{o(\rho)}{\rho} = 0.
    $$

    反之,若
    $$
    \lim_{\rho \to 0} \frac{\Delta z - f_x'(M_0) \Delta x - f_y'(M_0) \Delta y}{\rho} = 0,
    $$
    则
    $$
    \Delta - (f_x'(M_0) \Delta x + f_y'(M_0) \Delta y) = o(\rho) \Rightarrow \Delta z = f_x'(M_0) \Delta x + f_y'(M_0) \Delta y + o(\rho) = (A \Delta x + B \Delta y) + o(\rho),
    $$
    从而$f(x,y)$在$M_0$处可微.
\end{proof}

\begin{theorem}
    $z = f(x,y)$在$M_0(x_0,y_0)$处可微的充分必要条件是$f_x'(x_0,y_0),f_y'(x_0,y_0)$存在且连续.
\end{theorem}

\begin{proof}
    已知$f_x'(x,y),f_y'(x,y)$在$M_0$处存在且连续,则
    \begin{align*}
        \Delta z &= f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0) = \left[ f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0 + \Delta y) \right] + \left[ f(x_0, y_0 + \Delta y) - f(x_0, y_0) \right] \\
        &= f_x'(x_0 + \theta_1 \Delta x, y_0 + \Delta y) \Delta x + f_y'(x_0, y_0 + \theta_2 \Delta y) \Delta y,
    \end{align*}
    其中$\theta_1, \theta_2 \in (0,1)$.利用$f_x'(x,y),f_y'(x,y)$的连续性,得
    $$
    \lim_{\Delta x \to 0, \Delta y \to 0} f_x'(x_0 + \theta_1 \Delta x, y_0 + \Delta y) = f_x'(x_0, y_0)
    $$
    $$
    \lim_{\Delta x \to 0, \Delta y \to 0} f_y'(x_0, y_0 + \theta_2 \Delta y) = f_y'(x_0, y_0),
    $$
    从而
    $$
    f_x'(x_0 + \theta_1 \Delta x, y_0 + \Delta y) = f_x'(x_0, y_0) + \alpha_1, \quad \alpha_1 \to 0, \ (\Delta x \to 0, \Delta y \to 0),
    $$
    $$
    f_y'(x_0, y_0 + \theta_2 \Delta y) = f_y'(x_0, y_0) + \alpha_2, \quad \alpha_2 \to 0, \ (\Delta x \to 0, \Delta y \to 0),
    $$
    即
    $$
    \Delta z = (f_x'(M_0) + \alpha_1) \Delta x + (f_y'(M_0) + \alpha_2) \Delta y = f_x'(M_0) \Delta x + f_y'(M_0) \Delta y + \alpha_1 \Delta x + \alpha_2 \Delta y,
    $$
    且$\lim_{\rho \to 0} \frac{\alpha_1 \Delta x + \alpha_2 \Delta y}{\rho} = \lim_{\rho \to 0} ( \alpha_1 \cos \theta + \alpha_2 \sin \theta) = 0$,从而$\alpha_1 \Delta x + \alpha_2 \Delta y = o(\rho)$,所以
    $$
    \Delta z = f_x'(M_0) \Delta x + f_y'(M_0) \Delta y + o(\rho) = (A \Delta x + B \Delta y) + o(\rho),
    $$
    从而$f(x,y)$在$M_0$处可微.
\end{proof}

\begin{example}
    反例3: $z = f(x,y) = \begin{cases}
        (x^2 +y^2) \sin \frac{1}{\sqrt{x^2 + y^2}}, & (x,y) \neq (0,0), \\
        0, & (x,y) = (0,0).
    \end{cases}$
    在$(0,0)$处可微,但$f_x'(x,y),f_y'(x,y)$在$(0,0)$处不连续.
\end{example}

\section{高阶偏导数}

设$z = f(x,y) = x^2 + xy+y^2 + x^y + 3x+4y$,则
\begin{align*}
    &\frac{\partial z}{\partial x} = 2x + y + y x^{y-1} + 3, \\
    &\frac{\partial z}{\partial y} = x + 2y + x^y \ln x + 4.
\end{align*}

由此得
\begin{align*}
    &\frac{\partial^2 z}{\partial y \partial x} = \left( \frac{\partial z}{\partial x} \right)_y' = (2x + y + yx^{y-1} +3)_y' = 1 + x^{y-1} + y x^{y-1} \ln x, \\
    &\frac{\partial^2 z}{\partial x \partial y} = \left( \frac{\partial z}{\partial y} \right)_x' = (x + 2y + x^y \ln x + 4)_x' = 1 + x^{y-1} + y x^{y-1} \ln x.
\end{align*}

进一步得
\begin{align*}
    &\frac{\partial^3 z}{\partial x \partial y \partial x} = \left( \frac{\partial^2 z}{\partial y \partial x} \right)_x' = \left( 1 + x^{y-1} + y x^{y-1} \ln x \right)_x' =(y-1) x^{y-2} + y(y-1)x^{y-2} \ln x + y x^{y-2},\\
    &\frac{\partial^3 z}{\partial x^2 \partial y} = \left( \frac{\partial^2 z}{\partial x \partial y} \right)_x' = \left( 1 + x^y \ln x + y \right)_x' = (y-1) x^{y-2} + y(y-1)x^{y-2} \ln x + y x^{y-2}.
\end{align*}

对比得知,$\frac{\partial^2 z}{\partial y \partial x} ,\frac{\partial^2 z}{\partial x \partial y},\frac{\partial^2 z}{\partial x \partial y \partial x},\frac{\partial^2 z}{\partial y \partial x \partial y}$在区域$D:x >0$ 中连续,且
\begin{align*}
    \frac{\partial^2 z}{\partial y \partial x} & \equiv \frac{\partial^2 z}{\partial x \partial y}, \\
    \frac{\partial^3 z}{\partial x \partial y \partial x} & \equiv \frac{\partial^3 z}{\partial x^2 \partial y}.
\end{align*}
对于$(x,y) \in D$成立.

\begin{theorem}
    若$z = f(x,y)$在区域$D$中的高阶偏导数连续,则高阶偏导数与求偏导的顺序无关.
\end{theorem}

\begin{proof}
    仅证$\frac{\partial^2 z}{\partial y \partial x} = \frac{\partial^2 z}{\partial x \partial y}$.
    
    任取$M_0 = (x_0,y_0) \in D, B(M_0, r) \subset D$,取$h = \Delta x \neq 0, k = \Delta y \neq 0$,使得$(x_0 + h, y_0 + k) \in B(M_0, r)$,令
    \begin{align*}
        \varphi(x) = f(x, y_0 + k) - f(x, y),\\
        \psi(y) = f(x_0 + h, y) - f(x_0, y).
    \end{align*}

    是$f(x, y)$分别对于$x$和$y$的偏差分。容易验证，如果$\varphi(x)$和$\psi(y)$分别对$x$和$y$再进行差分，那么差分的结果是都等于$f(x, y)$的二阶混合差分（下列第二个等式的右端）
\begin{align*}
    \varphi(x_0 +h) - \varphi(x_0) & = \psi(y_0 +k) - \psi(y_0) \\
    &= f(x_0 + h, y_0 + k) - f(x_0 + h, y_0) - f(x_0, y_0 + k) + f(x_0, y_0).
\end{align*}
由一元函数的微分公式可得
\begin{align*}
    \varphi(x_0 + h) - \varphi(x_0) & = h \varphi' (x_0 + \theta_1 h) \\
    & = h \left(f'(x_0 + \theta_1 h, y_0 + k) - f'(x_0 + \theta_1 h, y_0)\right) \\
    & = h k f''_{xy}(x_0 + \theta_1 h, y_0 + \eta_1 k),
\end{align*}
其中$0 < \theta_1, \eta_1 < 1$。类比存在$0 < \theta_2, \eta_2 < 1$，使得
$$
\psi(y + k) - \psi(y_0) = h k f''_{yx}(x_0 + \theta_2 h, y_0 + \eta_2 k).
$$
故有
$$
f''_{xy}(x_0 + \theta_1 h, y_0 + \eta_1 k) = f''_{yx}(x_0 + \theta_2 h, y_0 + \eta_2 k).
$$
令$(h, k) \to (0, 0)$，由混合偏导数的连续性即可证明定理。
\end{proof}

\section{例题}

\begin{example}
    证明函数$u = \frac{1}{r} , r = \sqrt{x^2 + y^2 + z^2 } >0$满足Laplace方程
    $$
    \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} + \frac{\partial^2 u}{\partial z^2} \equiv equiv 0, \forall (x,y,z) \neq (0,0,0).
    $$
\end{example}

\begin{proof}
    $u = (x^2 + y^2 + z^2)^{-\frac{1}{2}} \Rightarrow \frac{\partial u}{\partial x} = -x (x^2 + y^2 + z^2)^{-\frac{3}{2}} \Rightarrow \frac{\partial^2 u}{\partial x^2} = - \frac{(x^2+y^2+z^2)-3x^2}{(x^2+y^2+z^2)^{\frac{5}{2}}}$.
    由于$u = (x^2 + y^2 + z^2)^{-\frac{1}{2}}$是关于$x,y,z$的对称函数,因此有
    $$
    \frac{\partial^2 u}{\partial y^2} = - \frac{(x^2+y^2+z^2)-3y^2}{(x^2+y^2+z^2)^{\frac{5}{2}}}, \frac{\partial^2 u}{\partial z^2} = - \frac{(x^2+y^2+z^2)-3z^2}{(x^2+y^2+z^2)^{\frac{5}{2}}}.
    $$
    $$
    \frac{\partial^2 u}{\partial z^2} = - \frac{(x^2+y^2+z^2)-3z^2}{(x^2+y^2+z^2)^{\frac{5}{2}}}.
    $$
    从而
    $$
    \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} + \frac{\partial^2 u}{\partial z^2} = - \frac{3(x^2+y^2+z^2) - 3(x^2+y^2+z^2)}{(x^2+y^2+z^2)^{\frac{5}{2}}} = 0.
    $$
\end{proof}

\begin{example}
    证明$u = \frac{1}{2a \sqrt{\pi t}} \e^{ - \frac{x^2}{4a^2 t}}, x >0, t>0, a>0$常数满足热传导方程
    $$
    \frac{\partial u}{\partial t} = a^2 \frac{\partial^2 u}{\partial x^2}.
    $$
\end{example}

\begin{proof}
    \begin{align*}
        \frac{\partial u}{\partial t} & = \frac{(t^{-\frac12})_t'}{2a \sqrt \pi} \e^{-\frac{x^2}{4a^2 t}} + \frac{1}{2a \sqrt \pi} \e^{-\frac{x^2}{4a^2 t}} \left( - \frac{x^2}{4a^2t} \right)_t' \\
        &= \frac{1}{2a \sqrt{\pi t} t} \e^{-\frac{x^2}{4a^2 t}}\left( -1 + \frac{x^2}{2a^2 t} \right).
    \end{align*}
        且有
        \begin{align*}
            \frac{\partial u}{\partial x} & = \frac{1}{2a \sqrt{\pi t}} \e^{- \frac{x^2}{4a^2 t}} \left( - \frac{x}{2a^2 t} \right), \\
            \frac{\partial^2 u}{\partial x^2} & = \frac{1}{4a \sqrt{\pi t}t} \e^{- \frac{x^2}{4a^2 t}} \left( \frac{x^2}{2a^4 t} - \frac{1}{a^2} \right).
        \end{align*}
        从而
        $$
        a^2 \frac{\partial^2 u}{\partial x^2} = \frac{\partial u}{\partial t}, \quad \forall t >0, x \in \R^+.
        $$
\end{proof}

\begin{example}
    $\forall \phi,\psi \in C^2(I)$, $u = \phi(x - at) + \psi(x+ at)$满足波动方程
    $$
    \frac{\partial^2 u}{\partial t^2} = a^2 \frac{\partial^2 u}{\partial x^2}.
    $$
    其中$a >0$为常数.
\end{example}

\begin{proof}
    令$\begin{cases}
        v = x - at, \\
        w = x + at,
    \end{cases}$,则$u = \phi(v) + \psi(w)$,且
    \begin{align*}
        \frac{\partial u}{\partial x} & = \phi'(v) \frac{\partial v}{\partial x} + \psi'(w) \frac{\partial w}{\partial x} = \phi'(v) + \psi'(w), \\
        \frac{\partial u}{\partial t} & = \phi'(v) \frac{\partial v}{\partial t} + \psi'(w) \frac{\partial w}{\partial t} = -a \phi'(v) + a \psi'(w).
    \end{align*}
    从而
    \begin{align*}
        \frac{\partial^2 u}{\partial x^2} & = \phi''(v) \frac{\partial v}{\partial x} + \psi''(w) \frac{\partial w}{\partial x} = \phi''(v) + \psi''(w), \\
        \frac{\partial^2 u}{\partial t^2} & = \phi''(v) \frac{\partial v}{\partial t} + \psi''(w) \frac{\partial w}{\partial t} = a^2 \phi''(v) + a^2 \psi''(w).
    \end{align*}
    因此有
    $$
    \frac{\partial^2 u}{\partial t^2} = a^2 \frac{\partial^2 u}{\partial x^2}, \quad \forall t >0, x \in \R.
    $$
\end{proof}

\begin{homework}
ex9.2:2(7),8,11,15,26,27,28.
\end{homework}